<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>EzWin32 (ez_win32.Ez_win32.V1.EzWin32)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">ez_win32</a> &#x00BB; <a href="../../index.html">Ez_win32</a> &#x00BB; <a href="../index.html">V1</a> &#x00BB; EzWin32</nav><header class="odoc-preamble"><h1>Module <code><span>V1.EzWin32</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#high-level-process-and-redirection-management">High-level process and redirection management</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-command"><a href="#val-command" class="anchor"></a><code><span><span class="keyword">val</span> command : <span><span>string array</span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-simulate_exec"><a href="#val-simulate_exec" class="anchor"></a><code><span><span class="keyword">val</span> simulate_exec : <span><span>string array</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-waitpids"><a href="#val-waitpids" class="anchor"></a><code><span><span class="keyword">val</span> waitpids : <span><span>int array</span> <span class="arrow">&#45;&gt;</span></span> int * <a href="../Unix/index.html#type-process_status">Unix.process_status</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-fileinfo"><a href="#type-fileinfo" class="anchor"></a><code><span><span class="keyword">type</span> fileinfo</span><span> = </span><span>{</span></code><ol><li id="type-fileinfo.dwFileAttributes" class="def record field anchored"><a href="#type-fileinfo.dwFileAttributes" class="anchor"></a><code><span>dwFileAttributes : int;</span></code></li><li id="type-fileinfo.ftCreationTime" class="def record field anchored"><a href="#type-fileinfo.ftCreationTime" class="anchor"></a><code><span>ftCreationTime : float;</span></code></li><li id="type-fileinfo.ftLastAccessTime" class="def record field anchored"><a href="#type-fileinfo.ftLastAccessTime" class="anchor"></a><code><span>ftLastAccessTime : float;</span></code></li><li id="type-fileinfo.ftLastWriteTime" class="def record field anchored"><a href="#type-fileinfo.ftLastWriteTime" class="anchor"></a><code><span>ftLastWriteTime : float;</span></code></li><li id="type-fileinfo.dwVolumeSerialNumber" class="def record field anchored"><a href="#type-fileinfo.dwVolumeSerialNumber" class="anchor"></a><code><span>dwVolumeSerialNumber : int;</span></code></li><li id="type-fileinfo.nFileSize" class="def record field anchored"><a href="#type-fileinfo.nFileSize" class="anchor"></a><code><span>nFileSize : int64;</span></code></li><li id="type-fileinfo.nNumberOfLinks" class="def record field anchored"><a href="#type-fileinfo.nNumberOfLinks" class="anchor"></a><code><span>nNumberOfLinks : int;</span></code></li><li id="type-fileinfo.nFileIndex" class="def record field anchored"><a href="#type-fileinfo.nFileIndex" class="anchor"></a><code><span>nFileIndex : int64;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value external anchored" id="val-getFileInformationByHandle"><a href="#val-getFileInformationByHandle" class="anchor"></a><code><span><span class="keyword">val</span> getFileInformationByHandle : <span><a href="../Unix/index.html#type-file_descr">Unix.file_descr</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-fileinfo">fileinfo</a></span></code></div></div><div class="odoc-spec"><div class="spec value external anchored" id="val-getFileInformationByName"><a href="#val-getFileInformationByName" class="anchor"></a><code><span><span class="keyword">val</span> getFileInformationByName : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-fileinfo">fileinfo</a></span></code></div></div><h6 id="high-level-process-and-redirection-management"><a href="#high-level-process-and-redirection-management" class="anchor"></a>High-level process and redirection management</h6><div class="odoc-spec"><div class="spec value anchored" id="val-create_process"><a href="#val-create_process" class="anchor"></a><code><span><span class="keyword">val</span> create_process : 
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>string array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Unix/index.html#type-file_descr">Unix.file_descr</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Unix/index.html#type-file_descr">Unix.file_descr</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Unix/index.html#type-file_descr">Unix.file_descr</a> <span class="arrow">&#45;&gt;</span></span>
  int</span></code></div><div class="spec-doc"><p><code>create_process prog args new_stdin new_stdout new_stderr</code> forks a new process that executes the program in file <code>prog</code>, with arguments <code>args</code>. The pid of the new process is returned immediately; the new process executes concurrently with the current process. The standard input and outputs of the new process are connected to the descriptors <code>new_stdin</code>, <code>new_stdout</code> and <code>new_stderr</code>. Passing e.g. <code>stdout</code> for <code>new_stdout</code> prevents the redirection and causes the new process to have the same standard output as the current process. The executable file <code>prog</code> is searched in the path. The new process has the same environment as the current process.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create_process_env"><a href="#val-create_process_env" class="anchor"></a><code><span><span class="keyword">val</span> create_process_env : 
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>string array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>string array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Unix/index.html#type-file_descr">Unix.file_descr</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Unix/index.html#type-file_descr">Unix.file_descr</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Unix/index.html#type-file_descr">Unix.file_descr</a> <span class="arrow">&#45;&gt;</span></span>
  int</span></code></div><div class="spec-doc"><p><code>create_process_env prog args env new_stdin new_stdout new_stderr</code> works as <a href="../Unix/index.html#val-create_process"><code>Unix.create_process</code></a>, except that the extra argument <code>env</code> specifies the environment passed to the program.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-open_process_in"><a href="#val-open_process_in" class="anchor"></a><code><span><span class="keyword">val</span> open_process_in : <span>string <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Stdlib</span>.in_channel</span></code></div><div class="spec-doc"><p>High-level pipe and process management. This function runs the given command in parallel with the program. The standard output of the command is redirected to a pipe, which can be read via the returned input channel. The command is interpreted by the shell <code>/bin/sh</code> (cf. <code>system</code>).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-open_process_out"><a href="#val-open_process_out" class="anchor"></a><code><span><span class="keyword">val</span> open_process_out : <span>string <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Stdlib</span>.out_channel</span></code></div><div class="spec-doc"><p>Same as <a href="../Unix/index.html#val-open_process_in"><code>Unix.open_process_in</code></a>, but redirect the standard input of the command to a pipe. Data written to the returned output channel is sent to the standard input of the command. Warning: writes on output channels are buffered, hence be careful to call <code>Pervasives.flush</code> at the right times to ensure correct synchronization.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-open_process"><a href="#val-open_process" class="anchor"></a><code><span><span class="keyword">val</span> open_process : <span>string <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Stdlib</span>.in_channel * <span class="xref-unresolved">Stdlib</span>.out_channel</span></code></div><div class="spec-doc"><p>Same as <a href="../Unix/index.html#val-open_process_out"><code>Unix.open_process_out</code></a>, but redirects both the standard input and standard output of the command to pipes connected to the two returned channels. The input channel is connected to the output of the command, and the output channel to the input of the command.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-open_process_full"><a href="#val-open_process_full" class="anchor"></a><code><span><span class="keyword">val</span> open_process_full : 
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>string array</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Stdlib</span>.in_channel * <span class="xref-unresolved">Stdlib</span>.out_channel * <span class="xref-unresolved">Stdlib</span>.in_channel</span></code></div><div class="spec-doc"><p>Similar to <a href="../Unix/index.html#val-open_process"><code>Unix.open_process</code></a>, but the second argument specifies the environment passed to the command. The result is a triple of channels connected respectively to the standard output, standard input, and standard error of the command.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-close_process_in"><a href="#val-close_process_in" class="anchor"></a><code><span><span class="keyword">val</span> close_process_in : <span><span class="xref-unresolved">Stdlib</span>.in_channel <span class="arrow">&#45;&gt;</span></span> <a href="../Unix/index.html#type-process_status">Unix.process_status</a></span></code></div><div class="spec-doc"><p>Close channels opened by <a href="../Unix/index.html#val-open_process_in"><code>Unix.open_process_in</code></a>, wait for the associated command to terminate, and return its termination status.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-close_process_out"><a href="#val-close_process_out" class="anchor"></a><code><span><span class="keyword">val</span> close_process_out : <span><span class="xref-unresolved">Stdlib</span>.out_channel <span class="arrow">&#45;&gt;</span></span> <a href="../Unix/index.html#type-process_status">Unix.process_status</a></span></code></div><div class="spec-doc"><p>Close channels opened by <a href="../Unix/index.html#val-open_process_out"><code>Unix.open_process_out</code></a>, wait for the associated command to terminate, and return its termination status.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-close_process"><a href="#val-close_process" class="anchor"></a><code><span><span class="keyword">val</span> close_process : 
  <span><span>(<span class="xref-unresolved">Stdlib</span>.in_channel * <span class="xref-unresolved">Stdlib</span>.out_channel)</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="../Unix/index.html#type-process_status">Unix.process_status</a></span></code></div><div class="spec-doc"><p>Close channels opened by <a href="../Unix/index.html#val-open_process"><code>Unix.open_process</code></a>, wait for the associated command to terminate, and return its termination status.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-close_process_full"><a href="#val-close_process_full" class="anchor"></a><code><span><span class="keyword">val</span> close_process_full : 
  <span><span>(<span class="xref-unresolved">Stdlib</span>.in_channel * <span class="xref-unresolved">Stdlib</span>.out_channel * <span class="xref-unresolved">Stdlib</span>.in_channel)</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="../Unix/index.html#type-process_status">Unix.process_status</a></span></code></div><div class="spec-doc"><p>Close channels opened by <a href="../Unix/index.html#val-open_process_full"><code>Unix.open_process_full</code></a>, wait for the associated command to terminate, and return its termination status.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create_process_chdir"><a href="#val-create_process_chdir" class="anchor"></a><code><span><span class="keyword">val</span> create_process_chdir : 
  <span><span class="optlabel">?chdir</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?env</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">cmd</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">stdin</span>:<a href="../Unix/index.html#type-file_descr">Unix.file_descr</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">stdout</span>:<a href="../Unix/index.html#type-file_descr">Unix.file_descr</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">stderr</span>:<a href="../Unix/index.html#type-file_descr">Unix.file_descr</a> <span class="arrow">&#45;&gt;</span></span>
  int</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-hroot"><a href="#type-hroot" class="anchor"></a><code><span><span class="keyword">type</span> hroot</span><span> = </span></code><ol><li id="type-hroot.HKEY_CLASSES_ROOT" class="def variant constructor anchored"><a href="#type-hroot.HKEY_CLASSES_ROOT" class="anchor"></a><code><span>| </span><span><span class="constructor">HKEY_CLASSES_ROOT</span></span></code></li><li id="type-hroot.HKEY_CURRENT_CONFIG" class="def variant constructor anchored"><a href="#type-hroot.HKEY_CURRENT_CONFIG" class="anchor"></a><code><span>| </span><span><span class="constructor">HKEY_CURRENT_CONFIG</span></span></code></li><li id="type-hroot.HKEY_CURRENT_USER" class="def variant constructor anchored"><a href="#type-hroot.HKEY_CURRENT_USER" class="anchor"></a><code><span>| </span><span><span class="constructor">HKEY_CURRENT_USER</span></span></code></li><li id="type-hroot.HKEY_LOCAL_MACHINE" class="def variant constructor anchored"><a href="#type-hroot.HKEY_LOCAL_MACHINE" class="anchor"></a><code><span>| </span><span><span class="constructor">HKEY_LOCAL_MACHINE</span></span></code></li><li id="type-hroot.HKEY_USERS" class="def variant constructor anchored"><a href="#type-hroot.HKEY_USERS" class="anchor"></a><code><span>| </span><span><span class="constructor">HKEY_USERS</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-dwType"><a href="#type-dwType" class="anchor"></a><code><span><span class="keyword">type</span> dwType</span><span> = </span></code><ol><li id="type-dwType.REG_SZ" class="def variant constructor anchored"><a href="#type-dwType.REG_SZ" class="anchor"></a><code><span>| </span><span><span class="constructor">REG_SZ</span></span></code></li><li id="type-dwType.REG_EXPAND_SZ" class="def variant constructor anchored"><a href="#type-dwType.REG_EXPAND_SZ" class="anchor"></a><code><span>| </span><span><span class="constructor">REG_EXPAND_SZ</span></span></code></li><li id="type-dwType.REG_DWORD" class="def variant constructor anchored"><a href="#type-dwType.REG_DWORD" class="anchor"></a><code><span>| </span><span><span class="constructor">REG_DWORD</span></span></code></li><li id="type-dwType.REG_QWORD" class="def variant constructor anchored"><a href="#type-dwType.REG_QWORD" class="anchor"></a><code><span>| </span><span><span class="constructor">REG_QWORD</span></span></code></li><li id="type-dwType.REG_BINARY" class="def variant constructor anchored"><a href="#type-dwType.REG_BINARY" class="anchor"></a><code><span>| </span><span><span class="constructor">REG_BINARY</span></span></code></li><li id="type-dwType.REG_NONE" class="def variant constructor anchored"><a href="#type-dwType.REG_NONE" class="anchor"></a><code><span>| </span><span><span class="constructor">REG_NONE</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-rkey_value"><a href="#type-rkey_value" class="anchor"></a><code><span><span class="keyword">type</span> rkey_value</span><span> = <span>string array</span> * string * <a href="#type-dwType">dwType</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_rkey"><a href="#val-string_of_rkey" class="anchor"></a><code><span><span class="keyword">val</span> string_of_rkey : <span><a href="#type-rkey_value">rkey_value</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-read_standard_config"><a href="#val-read_standard_config" class="anchor"></a><code><span><span class="keyword">val</span> read_standard_config : <span><a href="#type-rkey_value">rkey_value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-dwType">dwType</a> * string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-read_key"><a href="#val-read_key" class="anchor"></a><code><span><span class="keyword">val</span> read_key : <span><a href="#type-hroot">hroot</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-rkey_value">rkey_value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-dwType">dwType</a> * string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_key"><a href="#val-write_key" class="anchor"></a><code><span><span class="keyword">val</span> write_key : <span><a href="#type-hroot">hroot</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-rkey_value">rkey_value</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-delete_key"><a href="#val-delete_key" class="anchor"></a><code><span><span class="keyword">val</span> delete_key : <span><a href="#type-hroot">hroot</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-rkey_value">rkey_value</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-broadcast_setting_change"><a href="#val-broadcast_setting_change" class="anchor"></a><code><span><span class="keyword">val</span> broadcast_setting_change : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div></div></body></html>
